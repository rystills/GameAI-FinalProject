<html>
  <img src='redtriangle.png' id='redtriangle' style="display:none;">
  <img src='greentriangle.png' id='greentriangle' style="display:none;">
  <img src='bluetriangle.png' id='bluetriangle' style="display:none;">
  <img src='redsquare.png' id='redsquare' style="display:none;">
  <img src='greensquare.png' id='greensquare' style="display:none;">
  <img src='bluesquare.png' id='bluesquare' style="display:none;">
  <img src='redcircle.png' id='redcircle' style="display:none;">
  <img src='greencircle.png' id='greencircle' style="display:none;">
  <img src='bluecircle.png' id='bluecircle' style="display:none;">

  <head>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <link href='http://fonts.googleapis.com/css?family=Poiret+One' rel='stylesheet' type='text/css'>
    <style type="text/css">
      #myCanvas {
        cursor: none;
        border: double;
      }

      #randomObject:hover {}
    </style>
  </head>

  <body>
    <p id = "time"></p>

    <p id = "x-position"></p>

    <canvas id="myCanvas" width="1200" height="500" onmousedown="mouseDown(event);"></canvas>

    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
    <script>
      var curShape = 2;
      var curColor = 'red';
      var d = new Date();
      var begTime = d.getTime();
      var objects = [];
      var newObjectCounter = 0;
      var canvas = document.getElementById('myCanvas');
      var context = canvas.getContext('2d');
      var mousePos = {x:0,y:0};
      var currObjects = [];
      var notDead = true;
      var score = 0;
      var collisions = 0;
      var radius = 50;
      var scoreadded;

      function init(){
        var rect = canvas.getBoundingClientRect();
        document.addEventListener('mousemove', function(e){ 
          mousePos.x =  e.clientX - rect.left,
          mousePos.y =  e.clientY - rect.top
        }, false);
        scoreadded = false;
        setInterval(update, 15);
      }

      function update() {
        context.clearRect(0, 0, canvas.width, canvas.height);
        for (var i = 0; i < currObjects.length; i++) {
          if (currObjects[i].x < 0) {
            currObjects.shift();
            notDead = false;
          }
          if (checkCollision(currObjects[i])) {
            currObjects.shift(i);
          }
        }
        if (notDead) {
          render();
          drawShapes();
        } else {
          context.clearRect(0, 0, canvas.width, canvas.height);
          score = collisions;
          context.font = "25px Verdana";
          context.fillText('Your score is ' + score, 300, 200);
          setTimeout(function() {}, 1000);
        }
      }

      function checkCollision(Obj){
        if((Math.abs(mousePos.x - Obj.x) <= radius)  
          && (Math.abs(mousePos.y - Obj.y) <= radius)
          && (curColor == Obj.color)
          && (curShape == Obj.shape)
          ) {
          collisions++;
          return true;
        }
        return false;
      }

      function getRandomShape() {
        var num = Math.random();
        if (num <= .33) {
          return 2;
        } else if (num <= .67) {
          return 0;
        } else {
          return 1;
        };
      };

      function getRandomColor() {
        var num = Math.random();
        if (num <= .33) {
          return 'red';
        } else if (num <= .67) {
          return 'green';
        } else {
          return 'blue';
        };
      };

      function ObjectType() {
        this.shapeType = getRandomShape();
        this.colorType = getRandomColor();
        if (this.shapeType === 2) {
          this.width = 125;
          if (this.colorType === 'red') {
            this.image = document.getElementById('redtriangle');
            this.type = 'redtriangle';
          } else if (this.colorType === 'green') {
            this.image = document.getElementById('greentriangle');
            this.type = 'greentriangle';
          } else if (this.colorType === 'blue') {
            this.image = document.getElementById('bluetriangle');
            this.type = 'bluetriangle';
          };
        } else if (this.shapeType === 0) {
          this.width=100;
          if (this.colorType === 'red') {
            this.image = document.getElementById('redsquare');
            this.type = 'redsquare';
          } else if (this.colorType === 'green') {
            this.image = document.getElementById('greensquare');
            this.type = 'greensquare';
          } else if (this.colorType === 'blue') {
            this.image = document.getElementById('bluesquare');
            this.type = 'bluesquare';
          };
        } else if (this.shapeType === 1) {
          this.width=100;
          if (this.colorType === 'red') {
            this.image = document.getElementById('redcircle');
            this.type = 'redcircle'
          } else if (this.colorType === 'green') {
            this.image = document.getElementById('greencircle');
            this.type = 'greencircle';
          } else if (this.colorType === 'blue') {
            this.image = document.getElementById('bluecircle');
            this.type = 'bluecircle';
          };
        };
        var obj = new Object(this.type, this.colorType, this.shapeType, this.width);
        objects.push(obj);
        currObjects.push(obj);
      };

      function render()
      {
        var context = document.getElementById('myCanvas').getContext('2d');
        newObjectCounter = newObjectCounter + 1;
        if(newObjectCounter >= 110)
        {
          newObjectCounter = 0;
          ObjectType();
        };
        for (var i = 0; i < objects.length; i++){
          if (currObjects.indexOf(objects[i]) > -1) {
            objects[i].move();
          }
        };
        for (var i = 0; i < objects.length; i++) {
          if (currObjects.indexOf(objects[i]) > -1) {
            objects[i].draw(context);
          }
        };
      };

      function Object(type, color, shape, width)
      {
        this.x = 1200;
        this.y = Math.random()*400;
        this.speed = 5 + 10*(d.getTime() - begTime);
        this.color = color;
        this.shape = shape;
        this.width = width;
        this.height = 100;
        this.image = document.getElementById(type);
      };

      Object.prototype.draw = function(context)
      {
        context.drawImage(this.image, this.x, this.y, this.width, this.height);
      };

      Object.prototype.move = function()
      {
        this.x -= this.speed;
      };

      function getMousePos(canvas, evt) {
        var rect = canvas.getBoundingClientRect();
        return {
          x: evt.clientX - rect.left,
          y: evt.clientY - rect.top
        };
      };

      function mouseDown(e) {
        e = e || window.event;
        switch (e.which) {
          case 1: changeShapes(); break;
          case 3: doMouseDownRight(); break; 
        }
      }
      
      function drawTriangle(){
          context.beginPath();
          context.moveTo(mousePos.x-50,mousePos.y+(25*Math.sqrt(3)));
          context.lineTo(mousePos.x+50,mousePos.y+(25*Math.sqrt(3)));
          context.lineTo(mousePos.x,mousePos.y-(25*Math.sqrt(3)));
          context.lineTo(mousePos.x-50,mousePos.y+(25*Math.sqrt(3)));
          context.lineTo(mousePos.x+50,mousePos.y+(25*Math.sqrt(3)));
          context.fillStyle = curColor;
          context.fill();
          context.lineWidth = 5;
          context.strokeStyle = 'Black';
          context.stroke();
      }

      function drawSquare(){
        context.beginPath();
        context.fillStyle = curColor;
        context.strokeRect(mousePos.x-radius-2,mousePos.y-radius-2,(radius*2)+4,(radius*2)+4)
        context.fillRect(mousePos.x-radius,mousePos.y-radius,radius*2,radius*2)
        context.lineWidth = 5;
        context.strokeStyle = 'Black';
        context.strokeRect(mousePos.x-50, mousePos.y-50, 100, 100);
        context.closePath();
      }

      function drawCircle(){
        context.beginPath();
        context.arc(mousePos.x, mousePos.y, radius, 0, 2 * Math.PI, false);
        context.fillStyle = curColor;
        context.fill();
        context.lineWidth = 5;
        context.strokeStyle = 'black';
        context.stroke();
      }

      function changeShapes(){
        switch(curShape){
          case 0:
            curShape = 1;
            break;
          case 1:
            curShape = 2;
            break;
          case 2:
            curShape = 0;
            break;
        }
      }
      function drawShapes(){
        switch(curShape){
          case 0:
            drawSquare();
            break;
          case 1:
            drawCircle();
            break;
          case 2:
            drawTriangle();
            break;
        }
      }
      function doMouseDownRight(){
        switch(curColor){
          case 'red':
            curColor = 'green';
            break;
          case 'green':
            curColor = 'blue';
            break;
          case 'blue':
            curColor = 'red';
            break;
        }
      }

      canvas.addEventListener("contextmenu", function(e){
        e.preventDefault();
      }, false);
      $(document).ready(init);
    </script>
  </body>
</html>